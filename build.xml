<?xml version="1.0" encoding="UTF-8" ?>
<project name="jbrofuzz" default="build" basedir=".">
	
	<property name="app.name" value="jbrofuzz" />
	<property name="lic.dir" value="licenses" />
	
	<property name="version.num" value="08" />
	
	<property name="hlp.dir" value="help" />
	<property name="lib.dir" value="lib" />
	<property name="jar.dir" value="jar" />
	<property name="src.dir" value="src" />
	<property name="cls.dir" value="bin" />
	<property name="doc.dir" value="doc" />

  <patternset id="dest.exclude">
    <exclude name=".settings/" />
  </patternset>
	
  <path id="master-classpath" description="Master Classpath">
    <fileset dir="${lib.dir}">
      <include name="*.jar" />
    </fileset>
  </path>

  <target name="init" description="Setup for Build">
    <tstamp />
    <echo>Checking Directories</echo>
    <mkdir dir="${cls.dir}" />
  	<mkdir dir="${hlp.dir}" />
    <mkdir dir="${jar.dir}" />
    <mkdir dir="${doc.dir}" />
  </target>

  <target depends="init" name="compile" description="Compilation of Java">
    <echo>Compiling Java Files</echo>
    <javac srcdir="${src.dir}" destdir="${cls.dir}" debug="true" failonerror="true" classpathref="master-classpath" deprecation="true" source="1.5" target="1.5" />
  </target>

  <target name="resource">
    <echo>Copying Resources</echo>
    <copy todir="${cls.dir}">
      <fileset dir="${src.dir}">
        <include name="**/*.txt" />
      </fileset>
    </copy>
  </target>

  <target depends="resource,compile" name="archive">
    <echo>Creating .jar File</echo>
    <jar compress="true" destfile="${jar.dir}/${app.name}-${version.num}-${DSTAMP}.jar">
      <fileset dir="${cls.dir}">
        <patternset refid="dest.exclude" />
        <include name="**/*.*" />
      </fileset>
      <fileset dir="${jar.dir}">
      	<patternset refid="dest.exclude" />
      	<exclude name="**/*.jar" />
      	<exclude name="**/*.zip" />
      	<include name="**/jbrofuzz-*" />
      </fileset>
      <fileset dir="${lic.dir}">
      	<include name="LICENSE/*" />
      </fileset>
      <fileset dir=".">
      	<include name="help/*" />
      </fileset>
      <zipfileset src="${lib.dir}/commons-codec-1.3.jar" />
      <zipfileset src="${lib.dir}/commons-httpclient-3.1.jar" />
      <zipfileset src="${lib.dir}/commons-lang-2.3.jar" />
      <zipfileset src="${lib.dir}/commons-io-1.3.2.jar" />
      <zipfileset src="${lib.dir}/commons-logging-1.1.jar" />
      <zipfileset src="${lib.dir}/junit-4.1.jar" />
      <zipfileset src="${lib.dir}/ostermillerutils_1_06_00.jar" />
      <zipfileset src="${lib.dir}/jcckit.jar" />
      <manifest>
      	<attribute name="Implementation-Version" value="${version.num}" />
        <attribute name="Main-Class" value="org.owasp.jbrofuzz.JBroFuzz" />
      	<attribute name="Build-By" value="subere (at) uncon (dot) org" />
      </manifest>
    </jar>
  </target>

	<target name="clean">
		<delete verbose="true" failonerror="false" includeemptydirs="true">
			<fileset dir="${cls.dir}" />
			<fileset dir="${jar.dir}">
				<include name="*.jar" />
			</fileset>
		</delete>
	</target>

  <target name="javadoc">
    <javadoc author="true" destdir="doc" package="true" version="true">
      <fileset dir="${src.dir}" />
      <tag description="To Do:" name="todo" scope="all" />
    </javadoc>
  </target>

  <target depends="clean,init,compile,archive" name="build" />

</project>
